---
title: "Pink Tax Study 2 Data Analysis"
author: "Dingning Yang"
date: "2025-08-10"
format: 
 html:
    toc: true
    toc-depth: 3
    toc-title: "Table of Contents"
    number-sections: true
    highlight-style: github
    theme: cosmo
    fontsize: 1.25em
    linestretch: 1.5
---

```{r}
#| label: setup
#| include: false


# Install required packages
if(!require(tidyverse)){install.packages("tidyverse")}
if(!require(ggplot2)){install.packages("ggplot2")}
if(!require(readr)){install.packages("readr")}
if(!require(knitr)){install.packages("knitr")}
if(!require(broom)){install.packages("broom")}


if(!require(lmtest)){install.packages("lmtest")}
if(!require(ggpubr)){install.packages("ggpubr")}
if(!require(kableExtra)){install.packages("kableExtra")}
if(!require(effsize)){install.packages("effsize")}


if (!requireNamespace("nnet", quietly = TRUE)) {
  install.packages("nnet")
}
library(nnet)
# List of packages
required_packages <- c("tidyverse", "ggplot2", "readr", "knitr", "broom","lmtest", "ggpubr", "kableExtra","effsize")

lapply(required_packages, library, character.only = TRUE)
set.seed(123)




```

```{r}
#| label: Read Data
#| include: false

# You have to edit the path here to render output without error
raw.pink <- read_csv("C:/Users/yDn/Desktop/2025 Summer/Research/WO-Pink Tax/Study 2/Data Analysis/Datasets/raw.pink.study2.csv")


```

```{r}
#| label: Data Cleaning
#| include: false

# Remove unnecessary rows
raw.pink <- raw.pink %>% slice(-c(1:36)) # I deleted test responses and the first pilot batch due to different manipulations (high mc failure rate)

# Find IPs that appear more than once
duplicate_ips <- raw.pink %>%
  group_by(IPAddress) %>%
  summarise(count = n(), .groups = 'drop') %>%
  filter(count > 1) %>%
  arrange(desc(count))

print(duplicate_ips)

# Remove duplicate IPs, keeping only the first occurrence: N = 1007 after this
raw.pink <- raw.pink %>%
  arrange(IPAddress, StartDate) %>%  # Sort by IP and then by StartDate
  group_by(IPAddress) %>%            # Group by IP address
  slice(1) %>%                       # Keep only the first row in each group
  ungroup()                          # Remove grouping

# Attention checks: N = 999 after this (99.2%)
raw.pink <- raw.pink %>%
  filter(attention_check == 2)

# Check completeness: All completed the survey:) --> N = 999
table(raw.pink$Finished)
table(raw.pink$Progress) 

# Remove unnecessary columns
raw.pink <- raw.pink %>% select(-c(1:17))

raw.pink <- raw.pink %>% select(-c(3:30))

raw.pink <- raw.pink %>% select(-c(36:38))

# Check consent: All consent
table(raw.pink$consent_yn)
raw.pink <- raw.pink %>% select(-c(1:2))

# Manipulation checks - Price Difference: N = 938 after this (Success rate: 93.9%)
# Check the relationship between MainCondition and mc_price
manipulation_check <- raw.pink %>%
  count(MainCondition, mc_price) %>%
  arrange(MainCondition, mc_price)

print("Cross-tabulation of MainCondition and mc_price:")
print(manipulation_check)

# More detailed view
table(raw.pink$MainCondition, raw.pink$mc_price, useNA = "ifany")

# Create a flag for correct manipulation check responses
manipulation_analysis <- raw.pink %>%
  mutate(
    manipulation_correct = case_when(
      MainCondition == 1 & mc_price == 3 ~ TRUE,   # Condition 1 should have mc_price = 3
      MainCondition != 1 & mc_price == 1 ~ TRUE,   # Other conditions should have mc_price = 1
      TRUE ~ FALSE                                   # All other combinations are incorrect
    )
  )

# Summary of manipulation check results
manipulation_summary <- manipulation_analysis %>%
  summarise(
    total_responses = n(),
    correct_responses = sum(manipulation_correct, na.rm = TRUE),
    incorrect_responses = sum(!manipulation_correct, na.rm = TRUE),
    missing_data = sum(is.na(MainCondition) | is.na(mc_price)),
    success_rate = round(mean(manipulation_correct, na.rm = TRUE) * 100, 2)
  )

print("Manipulation Check Summary:")
print(manipulation_summary)

cleaned.pink <- raw.pink %>%
  filter(
    (MainCondition == 1 & mc_price == 3) |  # Condition 1 with correct response
    (MainCondition != 1 & mc_price == 1)    # Other conditions with correct response
  )

print(paste("Original dataset:", nrow(raw.pink), "rows"))
print(paste("After manipulation check filter:", nrow(cleaned.pink), "rows"))
print(paste("Removed:", nrow(raw.pink) - nrow(cleaned.pink), "rows"))

# Simple count by condition
condition_counts <- cleaned.pink %>%
  count(MainCondition, name = "n_participants") %>%
  arrange(MainCondition)

print("Number of participants in each condition:")
print(condition_counts)

# Control: N = 218, Pink Tax: N = 218, PT-Design: N = 98, PT-Color: N = 96, PT-Ingredient: N = 102, PT-Fragrance: N = 103, PT-Ad: N = 103 --> Mostly meet our setting for initial targets

#===============================================

# Rename, reorder, compose variables

cleaned.pink <- cleaned.pink %>%
  mutate(
    # Convert to numeric first
    across(price_fairness_5:price_fairness_8, as.numeric),
    # Then reverse code
    across(price_fairness_5:price_fairness_8, ~ 8 - .)
  )

cleaned.pink <- cleaned.pink %>%
  relocate(MainCondition, .before = everything()) %>%
  mutate(MainCondition = factor(MainCondition)) %>%
   rename(condition = MainCondition) %>% 
  arrange(condition)

cleaned.pink <- cleaned.pink %>%
  rename(product_choice = bi_binary)

cleaned.pink <- cleaned.pink %>%
  mutate(
    bi_women_1 = as.numeric(bi_women_1),
    bi_men_1 = as.numeric(bi_men_1),
    bi_women = bi_women_1 - bi_men_1
  ) %>%
  relocate(bi_women, .after = product_choice)

cleaned.pink <- cleaned.pink %>% select(-c(4:5))

cleaned.pink <- cleaned.pink %>%
  # First convert all price_fairness columns to numeric
  mutate(
    across(price_fairness_1:price_fairness_8, as.numeric)
  ) %>%
  # Then create the composite score
  rowwise() %>%
  mutate(
    price_fairness = mean(c_across(price_fairness_1:price_fairness_8), na.rm = TRUE)
  ) %>%
  ungroup() %>%
  relocate(price_fairness, .before = price_fairness_1)

cleaned.pink <- cleaned.pink %>% select(-c(5:12))

cleaned.pink <- cleaned.pink %>%
  rename(similarity = similarity_1)

cleaned.pink <- cleaned.pink %>%
  mutate(
    prosociality_1 = as.numeric(prosociality_1),
    prosociality_2 = as.numeric(prosociality_2),
    prosociality = prosociality_1 - prosociality_2
  ) %>%
  relocate(prosociality, .after = similarity)

cleaned.pink <- cleaned.pink %>% select(-c(7:8))

cleaned.pink <- cleaned.pink %>%
  mutate(
    value_alignment_1 = as.numeric(value_alignment_1),
    value_alignment_2 = as.numeric(value_alignment_2),
    value_alignment = value_alignment_1 - value_alignment_2
  ) %>%
  relocate(value_alignment, .after = prosociality)

cleaned.pink <- cleaned.pink %>% select(-c(8:9))

# First convert to numeric
gender_cols <- paste0("gender_equality_", 1:4)
cleaned.pink[gender_cols] <- lapply(cleaned.pink[gender_cols], as.numeric)

# Calculate Cronbach's alpha manually (avoids the psych package bug)
cronbach_alpha_manual <- function(data) {
  data <- data[complete.cases(data), ]
  k <- ncol(data)
  item_vars <- apply(data, 2, var, na.rm = TRUE)
  total_var <- var(rowSums(data, na.rm = TRUE), na.rm = TRUE)
  alpha <- (k / (k - 1)) * (1 - sum(item_vars) / total_var)
  return(alpha)
}

# Calculate reliability
gender_items <- cleaned.pink[, gender_cols]
reliability_alpha <- cronbach_alpha_manual(gender_items)
cat("Cronbach's Alpha:", round(reliability_alpha, 3), "\n")

# Alpha = 0.80, good reliability

cleaned.pink <- cleaned.pink %>%
  rowwise() %>%
  mutate(
    gender_equality = mean(c_across(gender_equality_1:gender_equality_4), na.rm = TRUE)
  ) %>%
  ungroup() %>%
  relocate(gender_equality, .after = value_alignment)

cleaned.pink <- cleaned.pink %>% select(-c(9:12))


cleaned.pink <- cleaned.pink %>% #Higher values mean higher price sensitivity
  mutate(
    # Convert to numeric first
    across(price_sensitivity_1:price_sensitivity_4, as.numeric),
    # Then reverse code
    across(price_sensitivity_2:price_sensitivity_3, ~ 8 - .)
  )

cleaned.pink <- cleaned.pink %>%
  rowwise() %>%
  mutate(
    price_sensitivity = mean(c_across(price_sensitivity_1:price_sensitivity_4), na.rm = TRUE)
  ) %>%
  ungroup() %>%
  relocate(price_sensitivity, .after = gender_equality)


cleaned.pink <- cleaned.pink %>% select(-c(10:13))

cleaned.pink <- cleaned.pink %>% select(-c(10:11))


cleaned.pink <- cleaned.pink %>%
  mutate(
    cost_women = coalesce(ce_control_women, ce_pt_women)
  ) %>%
  relocate(cost_women, .after = price_sensitivity)

cleaned.pink <- cleaned.pink %>%
  mutate(
    cost_men = coalesce(ce_control_men, ce_pt_men)
  ) %>%
  relocate(cost_men, .after = cost_women)

cleaned.pink <- cleaned.pink %>% select(-c(12:15))

cleaned.pink <- cleaned.pink %>%
  mutate(
    product_choice = factor(product_choice, 
                           levels = c(1, 2, 3))
  )

cleaned.pink <- cleaned.pink %>%
  mutate(
    similarity = as.numeric(similarity),
    cost_women = as.numeric(cost_women),
    cost_men = as.numeric(cost_men),
    income = as.numeric(income),
    age = as.numeric(age)
  )

# Adjust income

cleaned.pink[13, 13] <- 250
cleaned.pink[68, 13] <- 1350
cleaned.pink[685, 13] <- 3800

write.csv(cleaned.pink, "cleaned_pink_study2_dataset.csv", row.names = FALSE)

```

# Descriptive

```{r}
#| label: Descriptive

# Mean and SD of age
mean_age <- mean(cleaned.pink$age, na.rm = TRUE)
sd_age <- sd(cleaned.pink$age, na.rm = TRUE)

print(paste("Mean age:", round(mean_age, 2)))
print(paste("SD age:", round(sd_age, 2)))

# Mean = 44.5 years old, SD = 14.48, all female participants



```

# Main Effect

## Logistic Regression - Conditions' Impacts on Product Choice

### Control vs. Pink Tax
```{r}
#| label: Control vs. pink tax on product choice
#| include: false


control_pt <- cleaned.pink %>%
  filter(condition %in% c("1", "2")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 1 as reference
    condition = factor(condition, levels = c("1", "2"))
  )

# Check the coding
table(control_pt$condition, control_pt$chose_women_shampoo)

# Run the logistic regression
control_pt_logistic <- glm(chose_women_shampoo ~ condition, 
             data = control_pt, 
             family = binomial)

# View results
summary(control_pt_logistic)
exp(coef(control_pt_logistic))
exp(confint(control_pt_logistic))



```









```{r}
#| label: Control vs. pink tax on product choice plot
#| echo: false


# Create choice labels
choice_data <- control_pt %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "1" ~ "Control",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```



### Pink Tax vs. pink tax (design justifications)
```{r}
#| label: Pink tax vs. pink tax (design justifications)
#| include: false
pt_design <- cleaned.pink %>%
  filter(condition %in% c("2", "3A")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("2", "3A"))
  )

# Check the coding
table(pt_design$condition, pt_design$chose_women_shampoo)

# Run the logistic regression
pt_design_logistic <- glm(chose_women_shampoo ~ condition, 
             data = pt_design, 
             family = binomial)

# View results
summary(pt_design_logistic)
exp(coef(pt_design_logistic))
exp(confint(pt_design_logistic))
```

```{r}
#| label: Pink tax vs. pink tax (design justification) on product choice plot
#| echo: false


# Create choice labels
choice_data <- pt_design %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "3A" ~ "Pink Tax (Design justification)",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```


### Pink Tax vs. pink tax (color justifications)
```{r}
#| label: Pink tax vs. pink tax (color justifications)
#| include: false
pt_color <- cleaned.pink %>%
  filter(condition %in% c("2", "3B")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("2", "3B"))
  )

# Check the coding
table(pt_color$condition, pt_color$chose_women_shampoo)

# Run the logistic regression
pt_color_logistic <- glm(chose_women_shampoo ~ condition, 
             data = pt_color, 
             family = binomial)

# View results
summary(pt_color_logistic)
exp(coef(pt_color_logistic))
exp(confint(pt_color_logistic))
```

```{r}
#| label: Pink tax vs. pink tax (color justification) on product choice plot
#| echo: false


# Create choice labels
choice_data <- pt_color %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "3B" ~ "Pink Tax (color justification)",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```

### Pink Tax vs. pink tax (ingredient justifications)
```{r}
#| label: Pink tax vs. pink tax (ingredient justifications)
#| include: false
pt_ingredient <- cleaned.pink %>%
  filter(condition %in% c("2", "3C")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("2", "3C"))
  )

# Check the coding
table(pt_ingredient$condition, pt_ingredient$chose_women_shampoo)

# Run the logistic regression
pt_ingredient_logistic <- glm(chose_women_shampoo ~ condition, 
             data = pt_ingredient, 
             family = binomial)

# View results
summary(pt_ingredient_logistic)
exp(coef(pt_ingredient_logistic))
exp(confint(pt_ingredient_logistic))
```

The analysis revealed a significant positive effect of the ingredient condition compared to the pink tax condition (β = 0.63, SE = 0.25, z = 2.58, p = .01). In the pink tax condition (reference group), 48.2% of participants chose women's shampoo. However, participants in the ingredient condition showed a substantially higher preference for women's shampoo at 63.7%, representing a significant increase in choice likelihood. This shows that ingredient may be a more justified reason for marketers to communicate when there are price premiums for women's products. 


```{r}
#| label: Pink tax vs. pink tax (ingredient justification) on product choice plot
#| echo: false


# Create choice labels
choice_data <- pt_ingredient %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "3C" ~ "Pink Tax (ingredient justification)",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```

### Pink Tax vs. pink tax (fragrance justifications)
```{r}
#| label: Pink tax vs. pink tax (fragrance justifications)
#| include: false
pt_fragrance <- cleaned.pink %>%
  filter(condition %in% c("2", "3D")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("2", "3D"))
  )

# Check the coding
table(pt_fragrance$condition, pt_fragrance$chose_women_shampoo)

# Run the logistic regression
pt_fragrance_logistic <- glm(chose_women_shampoo ~ condition, 
             data = pt_fragrance, 
             family = binomial)

# View results
summary(pt_fragrance_logistic)
exp(coef(pt_fragrance_logistic))
exp(confint(pt_fragrance_logistic))
```

Insignificant. But the direction changes compared with the design and color justifications.

```{r}
#| label: Pink tax vs. pink tax (fragrance justification) on product choice plot
#| echo: false


# Create choice labels
choice_data <- pt_fragrance %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "3D" ~ "Pink Tax (fragrance justification)",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```
### Pink Tax vs. pink tax (mkt justifications)
```{r}
#| label: Pink tax vs. pink tax (mkt justifications)
#| include: false
pt_mkt <- cleaned.pink %>%
  filter(condition %in% c("2", "3E")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("2", "3E"))
  )

# Check the coding
table(pt_mkt$condition, pt_mkt$chose_women_shampoo)

# Run the logistic regression
pt_mkt_logistic <- glm(chose_women_shampoo ~ condition, 
             data = pt_mkt, 
             family = binomial)

# View results
summary(pt_mkt_logistic)
exp(coef(pt_mkt_logistic))
exp(confint(pt_mkt_logistic))
```

The analysis revealed a highly significant positive effect of the marketing condition compared to the pink tax condition (β = 0.73, SE = 0.25, z = 2.97, p = .003). In the pink tax condition (reference group), 48.2% of participants chose women's shampoo. However, participants in the marketing condition showed a substantially higher preference for women's shampoo at 66%. 

```{r}
#| label: Pink tax vs. pink tax (mkt justification) on product choice plot
#| echo: false


# Create choice labels
choice_data <- pt_mkt %>%
  mutate(
    choice_label = case_when(
      product_choice == 1 ~ "Women's Shampoo",
      product_choice == 2 ~ "Men's Shampoo", 
      product_choice == 3 ~ "None"
    ),
    condition_label = case_when(
      condition == "3E" ~ "Pink Tax (mkt justification)",
      condition == "2" ~ "Pink Tax"
    )
  ) %>%
  count(condition_label, choice_label) %>%
  group_by(condition_label) %>%
  mutate(
    total = sum(n),
    proportion = n / total
  )

ggplot(choice_data, aes(x = condition_label, y = proportion, fill = choice_label)) +
  geom_col(position = "stack") +
  geom_text(aes(label = paste0(round(proportion*100, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white", fontface = "bold") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Women's Shampoo" = "#e91e63", 
                              "Men's Shampoo" = "#2196f3", 
                              "None" = "#9e9e9e")) +
  labs(
    title = "Product Choice Distribution by Condition",
    x = "Condition",
    y = "Proportion",
    fill = "Product Choice"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold")
  )




```


## Linear Regression - Conditions' Impacts on Buying Intentions for Women's shampoo

### Control vs. pink tax

```{r}
#| label: Control vs. pink tax on buying intention
#| echo: false
options(scipen = 999)

# Linear regression with income as control variable
linear_control_pt <- lm(bi_women ~ condition + income, data = control_pt)

# View results
summary(linear_control_pt)





```


### Pink tax vs. pink tax (design justifications)

 
```{r}
#| label: Pink tax vs. pink tax (design justification)
#| echo: false

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design <- lm(bi_women ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design)





```


### Pink tax vs. pink tax (color justifications)

```{r}
#| label: Pink tax vs. pink tax (color justification)
#| echo: false

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color <- lm(bi_women ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color)



```

### Pink tax vs. pink tax (ingredient justifications)

Significantly higher buying intentions for women's shampoo (p = 0.037), consistent with the logistic regression result. 
```{r}
#| label: Pink tax vs. pink tax (ingredient justification)
#| echo: false

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient <- lm(bi_women ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient)



```

### Pink tax vs. pink tax (fragrance justifications)

```{r}
#| label: Pink tax vs. pink tax (fragrance justification)
#| echo: false
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance <- lm(bi_women ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance)



```

### Pink tax vs. pink tax (mkt justifications)

Significantly higher buying intentions (p = .015), consistent with the logistic regression. 
```{r}
#| label: Pink tax vs. pink tax (mkt justification)
#| echo: false

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt <- lm(bi_women ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt)



```

# Exploratory Analyses

## Control vs. Pink Tax with Justifications

### Logistic Regression - Product choice

Every pink tax with justification condition (significantly lower than control). Different from study 1, as the marketing message condition is indistinguishable from the control condition. 
```{r}
#| label: Control vs. Pink Tax with Justifications
#| echo: false

# Control vs. Pink Tax with design justification
ct_design <- cleaned.pink %>%
  filter(condition %in% c("1", "3A")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("1", "3A"))
  )


# Run the logistic regression
ct_design_logistic <- glm(chose_women_shampoo ~ condition, 
             data = ct_design, 
             family = binomial)

# View results
summary(ct_design_logistic)
exp(coef(ct_design_logistic))
exp(confint(ct_design_logistic))

# Control vs. Pink Tax with color justification
ct_color <- cleaned.pink %>%
  filter(condition %in% c("1", "3B")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("1", "3B"))
  )


# Run the logistic regression
ct_color_logistic <- glm(chose_women_shampoo ~ condition, 
             data = ct_color, 
             family = binomial)

# View results
summary(ct_color_logistic)
exp(coef(ct_color_logistic))
exp(confint(ct_color_logistic))

# Control vs. Pink Tax with ingredient justification
ct_ingredient <- cleaned.pink %>%
  filter(condition %in% c("1", "3C")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("1", "3C"))
  )


# Run the logistic regression
ct_ingredient_logistic <- glm(chose_women_shampoo ~ condition, 
             data = ct_ingredient, 
             family = binomial)

# View results
summary(ct_ingredient_logistic)
exp(coef(ct_ingredient_logistic))
exp(confint(ct_ingredient_logistic))

# Control vs. Pink Tax with fragrance justification
ct_fragrance <- cleaned.pink %>%
  filter(condition %in% c("1", "3D")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("1", "3D"))
  )


# Run the logistic regression
ct_fragrance_logistic <- glm(chose_women_shampoo ~ condition, 
             data = ct_fragrance, 
             family = binomial)

# View results
summary(ct_fragrance_logistic)
exp(coef(ct_fragrance_logistic))
exp(confint(ct_fragrance_logistic))

# Control vs. Pink Tax with marketing justification
ct_mkt <- cleaned.pink %>%
  filter(condition %in% c("1", "3E")) %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Make sure condition is factor with condition 2 as reference
    condition = factor(condition, levels = c("1", "3E"))
  )


# Run the logistic regression
ct_mkt_logistic <- glm(chose_women_shampoo ~ condition, 
             data = ct_mkt, 
             family = binomial)

# View results
summary(ct_mkt_logistic)
exp(coef(ct_mkt_logistic))
exp(confint(ct_mkt_logistic))



```


### Linear Regression - Buying intentions for women's shampoo


Same pattern. All conditions have significantly lower buying intentions for women's shampoo under the pink tax with justifications.

```{r}
#| label: Control vs. Pink Tax with Justifications - Linear
#| echo: false

# Control vs. Pink Tax with design justification
options(scipen = 999)

# Linear regression with income as control variable
linear_ct_design <- lm(bi_women ~ condition + income, data = ct_design)

# View results
summary(linear_ct_design)

# Control vs. Pink Tax with color justification

options(scipen = 999)

# Linear regression with income as control variable
linear_ct_color <- lm(bi_women ~ condition + income, data = ct_color)

# View results
summary(linear_ct_color)

# Control vs. Pink Tax with ingredient justification

options(scipen = 999)

# Linear regression with income as control variable
linear_ct_ingredient <- lm(bi_women ~ condition + income, data = ct_ingredient)

# View results
summary(linear_ct_ingredient)


# Control vs. Pink Tax with fragrance justification

options(scipen = 999)

# Linear regression with income as control variable
linear_ct_fragrance <- lm(bi_women ~ condition + income, data = ct_fragrance)

# View results
summary(linear_ct_fragrance)

# Control vs. Pink Tax with marketing justification

options(scipen = 999)

# Linear regression with income as control variable
linear_ct_mkt <- lm(bi_women ~ condition + income, data = ct_mkt)

# View results
summary(linear_ct_mkt)


```

## Pink Tax vs. Pink Tax with Justifications on Similarity, prosociality, value alignment, Estimated Costs, and Price Fairness

### Perceived Similarity

There is no significant difference of perceived similarity of women and men's shampoo under the design, fragrance, and marketing message justifications compared with the pink tax condition.

The perceived similarity is significantly lower under the ingredient justification condition (p = .007), and significantly higher under the color justification condition (p = .015).

```{r}
#| label: Pink Tax vs. Pink Tax with Justifications - Similarity
#| echo: false

# Pink Tax vs. Pink Tax with design justification

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design_sim <- lm(similarity ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design_sim)


# Pink Tax vs. Pink Tax with color justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color_sim <- lm(similarity ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color_sim)


# Pink Tax vs. Pink Tax with ingredient justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient_sim <- lm(similarity ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_sim)

# Pink Tax vs. Pink Tax with fragrance justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance_sim <- lm(similarity ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_sim)

# Pink Tax vs. Pink Tax with marketing justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt_sim <- lm(similarity ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt_sim)

```


### Perceived Brand Prosociality

The perceived brand prosociality is significantly higher under the marketing message justification condition (p < .001), design condition (p = .004), and the fragrance condition (p = .004).

```{r}
#| label: Pink Tax vs. Pink Tax with Justifications - Prosociality
#| echo: false

# Pink Tax vs. Pink Tax with design justification

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design_sim <- lm(prosociality ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design_sim)


# Pink Tax vs. Pink Tax with color justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color_sim <- lm(prosociality ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color_sim)


# Pink Tax vs. Pink Tax with ingredient justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient_sim <- lm(prosociality ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_sim)

# Pink Tax vs. Pink Tax with fragrance justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance_sim <- lm(prosociality ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_sim)

# Pink Tax vs. Pink Tax with marketing justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt_sim <- lm(prosociality ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt_sim)

```

### Value Alignment

The value alignment is significantly higher under the marketing message justification condition (p < .001), and insignificant for all others. I think this may explain better compared with prosociality (as some participants may don't understand what prosociality mean). 

```{r}
#| label: Pink Tax vs. Pink Tax with Justifications - Value Alignment
#| echo: false

# Pink Tax vs. Pink Tax with design justification

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design_sim <- lm(value_alignment ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design_sim)


# Pink Tax vs. Pink Tax with color justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color_sim <- lm(value_alignment ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color_sim)


# Pink Tax vs. Pink Tax with ingredient justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient_sim <- lm(value_alignment ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_sim)

# Pink Tax vs. Pink Tax with fragrance justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance_sim <- lm(value_alignment ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_sim)

# Pink Tax vs. Pink Tax with marketing justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt_sim <- lm(value_alignment ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt_sim)

```


### Estimated costs

Insignificant for all conditions. 

```{r}
#| label: Pink Tax vs. Pink Tax with Justifications - Costs
#| echo: false


# Pink Tax vs. Pink Tax with design justification

pt_design <- pt_design %>%
  mutate(cost_diff = cost_women - cost_men)

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design_cost <- lm(cost_diff ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design_cost)


# Pink Tax vs. Pink Tax with color justification

pt_color <- pt_color %>%
  mutate(cost_diff = cost_women - cost_men)

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color_cost <- lm(cost_diff ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color_cost)


# Pink Tax vs. Pink Tax with ingredient justification

pt_ingredient <- pt_ingredient %>%
  mutate(cost_diff = cost_women - cost_men)

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient_cost <- lm(cost_diff ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_cost)

# Pink Tax vs. Pink Tax with fragrance justification

pt_fragrance <- pt_fragrance %>%
  mutate(cost_diff = cost_women - cost_men)

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance_cost <- lm(cost_diff ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_cost)

# Pink Tax vs. Pink Tax with marketing justification

pt_mkt <- pt_mkt %>%
  mutate(cost_diff = cost_women - cost_men)

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt_cost <- lm(cost_diff ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt_cost)






```


### Price Fairness

No difference for design, color, and fragrance justification.

Significantly more fair for ingredient justification (p = 0.037) and marginally significantly higher than the marketing justification (p = 0.052), consistent with the higher buying intentions.

```{r}
#| label: Pink Tax vs. Pink Tax with Justifications - Price fairness
#| echo: false

# Pink Tax vs. Pink Tax with design justification

options(scipen = 999)

# Linear regression with income as control variable
linear_pt_design_pf <- lm(price_fairness ~ condition + income, data = pt_design)

# View results
summary(linear_pt_design_pf)


# Pink Tax vs. Pink Tax with color justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_color_pf <- lm(price_fairness ~ condition + income, data = pt_color)

# View results
summary(linear_pt_color_pf) #Significantly unfair


# Pink Tax vs. Pink Tax with ingredient justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_ingredient_pf <- lm(price_fairness ~ condition + income, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_pf)

# Pink Tax vs. Pink Tax with fragrance justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_fragrance_pf <- lm(price_fairness ~ condition + income, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_pf)

# Pink Tax vs. Pink Tax with mkt justification
options(scipen = 999)

# Linear regression with income as control variable
linear_pt_mkt_pf <- lm(price_fairness ~ condition + income, data = pt_mkt)

# View results
summary(linear_pt_mkt_pf)

```


## Mediation Models

### Perceived similarity as a mediator

#### Product choice

Only significant for ingredient justification.

The causal mediation analysis demonstrates significant mediation with a positive indirect effect. The Average Causal Mediation Effect (ACME) is 0.050 with a 95% confidence interval of [0.013, 0.097] and p-value of 0.008, indicating that the mediator significantly facilitates the relationship between the treatment and outcome. The Average Direct Effect (ADE) is marginally significant at 0.101 (95% CI [-0.011, 0.214], p = 0.073), suggesting a borderline direct effect of the treatment on the outcome beyond what is explained by the mediator. The total effect is significant and positive (0.151, 95% CI [0.038, 0.266], p = 0.008), indicating an overall beneficial treatment effect. Notably, the proportion mediated is 33% (95% CI [8.4%, 110%], p = 0.016), meaning approximately one-third of the total treatment effect operates through the mediating pathway, while the remaining two-thirds may work through other mechanisms or direct pathways. 



```{r}
#| label: Similarity Mediation - Product choice
#| echo: false
#| include: false

options(repos = c(CRAN = "https://cran.rstudio.com/"))

# Install packages if needed
if(!require(mediation)) install.packages("mediation")
library(mediation)

# Pink Tax vs. Pink Tax with design justification: No effect

pt_design <- pt_design %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Create binary IV: 0 = pink tax (condition 2), 1 = design justification (condition 3A)
    design_condition = ifelse(condition == "3A", 1, 0)
  )

# Check the coding
table(pt_design$condition, pt_design$design_condition)
table(pt_design$condition, pt_design$chose_women_shampoo)



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(similarity ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ design_condition + similarity, 
                 data = pt_design, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

pt_color <- pt_color %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Create binary IV: 0 = pink tax (condition 2), 1 = design justification (condition 3A)
    color_condition = ifelse(condition == "3B", 1, 0)
  )

# Check the coding
table(pt_color$condition, pt_color$color_condition)
table(pt_color$condition, pt_color$chose_women_shampoo)




# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(similarity ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ color_condition + similarity, 
                 data = pt_color, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

pt_ingredient <- pt_ingredient %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Create binary IV: 0 = pink tax (condition 2), 1 = design justification (condition 3A)
    ingredient_condition = ifelse(condition == "3C", 1, 0)
  )

# Check the coding
table(pt_ingredient$condition, pt_ingredient$ingredient_condition)
table(pt_ingredient$condition, pt_ingredient$chose_women_shampoo)



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(similarity ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ ingredient_condition + similarity, 
                 data = pt_ingredient, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)




# Pink Tax vs. Pink Tax with fragrance justification: No effect

pt_fragrance <- pt_fragrance %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Create binary IV: 0 = pink tax (condition 2), 1 = design justification (condition 3A)
    fragrance_condition = ifelse(condition == "3D", 1, 0)
  )

# Check the coding
table(pt_fragrance$condition, pt_fragrance$fragrance_condition)
table(pt_fragrance$condition, pt_fragrance$chose_women_shampoo)



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(similarity ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ fragrance_condition + similarity, 
                 data = pt_fragrance, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

pt_mkt <- pt_mkt %>%
  mutate(
    # Create binary DV: 1 = women's shampoo, 0 = all else
    chose_women_shampoo = ifelse(product_choice == 1, 1, 0),
    # Create binary IV: 0 = pink tax (condition 2), 1 = design justification (condition 3A)
    mkt_condition = ifelse(condition == "3E", 1, 0)
  )

# Check the coding
table(pt_mkt$condition, pt_mkt$mkt_condition)
table(pt_mkt$condition, pt_mkt$chose_women_shampoo)



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(similarity ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ mkt_condition + similarity, 
                 data = pt_mkt, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

```


#### Purchase intention

Same pattern. 

```{r}
#| label: Similarity Mediation - Purchase intention
#| echo: false
#| include: false

# Pink Tax vs. Pink Tax with design justification: No effect
# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(similarity ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ design_condition + similarity, data = pt_design)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(similarity ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ color_condition + similarity, data = pt_color)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(similarity ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ ingredient_condition + similarity, data = pt_ingredient)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with fragrance justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(similarity ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ fragrance_condition + similarity, data = pt_fragrance)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(similarity ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ mkt_condition + similarity, data = pt_mkt)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "similarity",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

```


### Perceived brand sociality as a mediator

#### Product choice

Marginally significant for marketing message. 
```{r}
#| label: Prosociality Mediation - Product choice
#| echo: false
#| include: false


# Pink Tax vs. Pink Tax with design justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(prosociality ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ design_condition + prosociality, 
                 data = pt_design, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(prosociality ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ color_condition + prosociality, 
                 data = pt_color, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(prosociality ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ ingredient_condition + prosociality, 
                 data = pt_ingredient, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)




# Pink Tax vs. Pink Tax with fragrance justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(prosociality ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ fragrance_condition + prosociality, 
                 data = pt_fragrance, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(prosociality ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ mkt_condition + prosociality, 
                 data = pt_mkt, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

```

#### Purchase intention

Same pattern. 

```{r}
#| label: Prosociality Mediation - Purchase intention
#| echo: false
#| include: false

# Pink Tax vs. Pink Tax with design justification: No effect
# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(prosociality ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ design_condition + prosociality, data = pt_design)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(prosociality ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ color_condition + prosociality, data = pt_color)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(prosociality ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ ingredient_condition + prosociality, data = pt_ingredient)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with fragrance justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(prosociality ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ fragrance_condition + prosociality, data = pt_fragrance)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(prosociality ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ mkt_condition + prosociality, data = pt_mkt)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "prosociality",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

```

### Value Alignment as a mediator

#### Product choice

Nearly full mediation for the marketing message condition. Value alignment significantly mediates the relationship between the marketing message and the purchase intention. 

Insignificant for all others. 

The causal mediation analysis demonstrates strong and significant mediation, with the treatment operating primarily through the indirect pathway. The Average Causal Mediation Effect (ACME) is 0.149 with a 95% confidence interval of [0.089, 0.214] and p-value < 0.001, indicating a highly significant indirect effect through the mediator. In contrast, the Average Direct Effect (ADE) is not significant at 0.038 (95% CI [-0.075, 0.155], p = 0.500), suggesting that the treatment has no meaningful direct effect on the outcome after accounting for the mediator. The total effect is significant and positive (0.187, 95% CI [0.069, 0.300], p < 0.001), confirming a strong overall beneficial treatment effect. Most notably, the proportion mediated is 80% (95% CI [42%, 199%], p < 0.001), indicating that approximately 80% of the total treatment effect operates through the mediating pathway. 
```{r}
#| label: Value Alignment Mediation - Product choice
#| echo: false
#| include: false


# Pink Tax vs. Pink Tax with design justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(value_alignment ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ design_condition + value_alignment, 
                 data = pt_design, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(value_alignment ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ color_condition + value_alignment, 
                 data = pt_color, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(value_alignment ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ ingredient_condition + value_alignment, 
                 data = pt_ingredient, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)




# Pink Tax vs. Pink Tax with fragrance justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(value_alignment ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ fragrance_condition + value_alignment, 
                 data = pt_fragrance, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect



# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(value_alignment ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ mkt_condition + value_alignment, 
                 data = pt_mkt, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

```


#### Purchase intention

Same pattern. 

```{r}
#| label: Value Alignment Mediation - Purchase intention
#| echo: false
#| include: false

# Pink Tax vs. Pink Tax with design justification: No effect
# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(value_alignment ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ design_condition + value_alignment, data = pt_design)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(value_alignment ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ color_condition + value_alignment, data = pt_color)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(value_alignment ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ ingredient_condition + value_alignment, data = pt_ingredient)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with fragrance justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(value_alignment ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ fragrance_condition + value_alignment, data = pt_fragrance)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(value_alignment ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ mkt_condition + value_alignment, data = pt_mkt)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "value_alignment",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

```

### Estimated cost as a mediator

#### Product choice

Insignificant for all, except the ingredient condition. 


The causal mediation analysis demonstrates significant partial mediation with the treatment operating through both indirect and direct pathways. The Average Causal Mediation Effect (ACME) is 0.045 with a 95% confidence interval of [0.009, 0.083] and p-value of 0.009, indicating a significant indirect effect through the mediator. The Average Direct Effect (ADE) is also significant at 0.100 (95% CI [0.007, 0.215], p = 0.033), demonstrating that the treatment has a meaningful direct effect on the outcome beyond what is explained by the mediator. The total effect is significant and positive (0.146, 95% CI [0.050, 0.254], p = 0.003), confirming a strong overall beneficial treatment effect. The proportion mediated is 31% (95% CI [6.0%, 86.9%], p = 0.012), indicating that approximately one-third of the total treatment effect operates through the mediating pathway, while the remaining two-thirds works through direct mechanisms or other pathways. 
```{r}
#| label: Estimated Cost Mediation - Product choice
#| echo: false
#| include: false


# Pink Tax vs. Pink Tax with design justification: No effect

# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(cost_diff ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ design_condition + cost_diff, 
                 data = pt_design, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(cost_diff ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ color_condition + cost_diff, 
                 data = pt_color, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Partial mediation effect

# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(cost_diff ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ ingredient_condition + cost_diff, 
                 data = pt_ingredient, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)


# Pink Tax vs. Pink Tax with fragrance justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(cost_diff ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ fragrance_condition + cost_diff, 
                 data = pt_fragrance, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(cost_diff ~ mkt_condition, data = pt_mkt)
                 
# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ mkt_condition + cost_diff, 
                 data = pt_mkt, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

```




#### Purchase intention

Same pattern. No further explanation. 


```{r}
#| label: Estimated Cost Mediation - Purchase intention
#| echo: false
#| include: false

# Pink Tax vs. Pink Tax with design justification: No effect
# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(cost_diff ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ design_condition + cost_diff, data = pt_design)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(cost_diff ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ color_condition + cost_diff, data = pt_color)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(cost_diff ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ ingredient_condition + cost_diff, data = pt_ingredient)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with fragrance justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(cost_diff ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ fragrance_condition + cost_diff, data = pt_fragrance)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(cost_diff ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ mkt_condition + cost_diff, data = pt_mkt)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "cost_diff",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

```

### Perceived price fairness as a mediator

#### Product choice

Insignificant for design, color, and fragrance. 

For ingredient justifications, the causal mediation analysis demonstrates significant partial mediation with the treatment operating through both indirect and direct pathways. The Average Causal Mediation Effect (ACME) is 0.039 with a 95% confidence interval of [0.004, 0.075] and p-value of 0.028, indicating a significant indirect effect through the mediator. The Average Direct Effect (ADE) is also significant at 0.117 (95% CI [0.012, 0.224], p = 0.031), demonstrating that the treatment has a meaningful direct effect on the outcome beyond what is explained by the mediator. The total effect is significant and positive (0.156, 95% CI [0.042, 0.269], p = 0.008), confirming a strong overall beneficial treatment effect. The proportion mediated is 25% (95% CI [2.8%, 72.8%], p = 0.033), indicating that approximately one-quarter of the total treatment effect operates through the mediating pathway, while the remaining three-quarters works through direct mechanisms or other pathways. 

For marketing message justifications, the causal mediation analysis demonstrates significant partial mediation with the treatment operating predominantly through direct pathways. The Average Causal Mediation Effect (ACME) is 0.028 with a 95% confidence interval of [0.001, 0.061] and p-value of 0.044, indicating a modest but significant indirect effect through the mediator. The Average Direct Effect (ADE) is highly significant at 0.148 (95% CI [0.040, 0.259], p = 0.007), demonstrating a strong direct effect of the treatment on the outcome that substantially exceeds the mediated effect. The total effect is significant and positive (0.176, 95% CI [0.067, 0.288], p = 0.002), confirming a robust overall beneficial treatment effect. The proportion mediated is relatively small at 16% (95% CI [0.5%, 46.5%], p = 0.046), indicating that approximately one-sixth of the total treatment effect operates through the mediating pathway, while the remaining 84% works through direct mechanisms or other pathways.
```{r}
#| label: Price Fairness Mediation - Product choice
#| echo: false
#| include: false


# Pink Tax vs. Pink Tax with design justification: No effect

# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(price_fairness ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ design_condition + price_fairness, 
                 data = pt_design, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(price_fairness ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ color_condition + price_fairness, 
                 data = pt_color, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Strong mediation effect

# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(price_fairness ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ ingredient_condition + price_fairness, 
                 data = pt_ingredient, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)


# Pink Tax vs. Pink Tax with fragrance justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(price_fairness ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ fragrance_condition + price_fairness, 
                 data = pt_fragrance, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: No effect


# Step 1: Mediator model (IV -> Mediator)
med_model <- lm(price_fairness ~ mkt_condition, data = pt_mkt)
                 
# Step 2: Outcome model (IV + Mediator -> DV)
out_model <- glm(chose_women_shampoo ~ mkt_condition + price_fairness, 
                 data = pt_mkt, family = binomial)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

```


#### Purchase intention

Same pattern. No further explanation. 


```{r}
#| label: Perceived price fairness Mediation - Purchase intention
#| echo: false
#| include: false

# Pink Tax vs. Pink Tax with design justification: No effect
# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(price_fairness ~ design_condition, data = pt_design)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ design_condition + price_fairness, data = pt_design)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "design_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with color justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(price_fairness ~ color_condition, data = pt_color)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ color_condition + price_fairness, data = pt_color)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "color_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)

# View results
summary(med_results)

# Pink Tax vs. Pink Tax with ingredient justification: Significant effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(price_fairness ~ ingredient_condition, data = pt_ingredient)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ ingredient_condition + price_fairness, data = pt_ingredient)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "ingredient_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with fragrance justification: No effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(price_fairness ~ fragrance_condition, data = pt_fragrance)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ fragrance_condition + price_fairness, data = pt_fragrance)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "fragrance_condition", 
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

# Pink Tax vs. Pink Tax with marketing justification: Weak effect

# Step 1: Mediator model (IV -> Mediator) - Linear regression
med_model <- lm(price_fairness ~ mkt_condition, data = pt_mkt)

# Step 2: Outcome model (IV + Mediator -> DV) - Linear regression
out_model <- lm(bi_women ~ mkt_condition + price_fairness, data = pt_mkt)

# Step 3: Mediation analysis
med_results <- mediate(med_model, out_model, 
                       treat = "mkt_condition",
                       mediator = "price_fairness",
                       boot = TRUE, sims = 5000)
# View results
summary(med_results)

```

## Moderation Analysis

### Logistic Regression - Product Choice

The comparison between control and pink tax as well as pink tax with justification conditions reveals that under the control condition, gender equality has marginally significant positive effects on product choice of women's shampoo (i.e., higher awareness, more product choices). Nevertheless, when there is a pink tax, gender equality's positive effects reverse, leading to significantly fewer product choices of women's shampoo, suggesting that the effect is mainly driven by those with higher gender attitudes. Price sensitivity consistently predicts lower product choice for women's shampoo across all conditions, with no significant interaction effects, meaning that higher price sensitivity results in fewer product choices of women's shampoo across conditions. The effect applies for all pink tax with justification conditions except for the marketing message justification, indicating that the marketing message justification mitigates the negative effect of pink tax alone (and may also align with gender equality awareness). 


```{r}
#| label: Moderation Analysis - Logistic Regression - Product Choice
#| echo: false

# 1. Control vs. Pink tax - 

# Run the logistic regression
control_pt_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity + income,
             data = control_pt, 
             family = binomial)

# View results
summary(control_pt_logistic_mod)
exp(coef(control_pt_logistic_mod))
exp(confint(control_pt_logistic_mod))


control_design_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income,
             data = ct_design, 
             family = binomial)

# View results
summary(control_design_logistic_mod)
exp(coef(control_design_logistic_mod))
exp(confint(control_design_logistic_mod))

control_color_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income,
             data = ct_color, 
             family = binomial)

# View results
summary(control_color_logistic_mod)
exp(coef(control_color_logistic_mod))
exp(confint(control_color_logistic_mod))

control_ingredient_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income,
             data = ct_ingredient, 
             family = binomial)

# View results
summary(control_ingredient_logistic_mod)
exp(coef(control_ingredient_logistic_mod))
exp(confint(control_ingredient_logistic_mod))

control_fragrance_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income,
             data = ct_fragrance, 
             family = binomial)

# View results
summary(control_fragrance_logistic_mod)
exp(coef(control_fragrance_logistic_mod))
exp(confint(control_fragrance_logistic_mod))


control_mkt_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income,
             data = ct_mkt, 
             family = binomial)

# View results
summary(control_mkt_logistic_mod)
exp(coef(control_mkt_logistic_mod))
exp(confint(control_mkt_logistic_mod))


# 2. Pink tax vs. Pink tax (design justification) - Gender equality and price sensitivity significantly predict lower product choice (no interaction)

# Run the logistic regression
pt_design_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity + income, 
                              data = pt_design, 
                              family = binomial)

# View results
summary(pt_design_logistic_mod)
exp(coef(pt_design_logistic_mod))
exp(confint(pt_design_logistic_mod))

# 3. Pink tax vs. Pink tax (color justification) - Gender equality and price sensitivity significantly predict lower product choice (no interaction): Same

# Run the logistic regression
pt_color_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income, 
                              data = pt_color, 
                              family = binomial)

# View results
summary(pt_color_logistic_mod)
exp(coef(pt_color_logistic_mod))
exp(confint(pt_color_logistic_mod))

# 4. Pink tax vs. Pink tax (ingredient justification) - Gender equality and price sensitivity significantly predict lower product choice (no interaction): Same

# Run the logistic regression
pt_ingredient_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income, 
                              data = pt_ingredient, 
                              family = binomial)

# View results
summary(pt_ingredient_logistic_mod)
exp(coef(pt_ingredient_logistic_mod))
exp(confint(pt_ingredient_logistic_mod))

# 5. Pink tax vs. Pink tax (fragrance justification) - Gender equality and price sensitivity significantly predict lower product choice (no interaction): Same

# Run the logistic regression
pt_fragrance_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income, 
                              data = pt_fragrance, 
                              family = binomial)

# View results
summary(pt_fragrance_logistic_mod)
exp(coef(pt_fragrance_logistic_mod))
exp(confint(pt_fragrance_logistic_mod))

# 6. Pink tax vs. Pink tax (mkt justification) - Gender equality and price sensitivity significantly predict lower product choice (no interaction): Same

# Run the logistic regression
pt_mkt_logistic_mod <- glm(chose_women_shampoo ~ condition + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity+ income, 
                              data = pt_mkt, 
                              family = binomial)

# View results
summary(pt_mkt_logistic_mod)
exp(coef(pt_mkt_logistic_mod))
exp(confint(pt_mkt_logistic_mod))



```



### Linear Regression - Purchase intention

For purchase intention, under the control condition, neither price sensitivity nor gender equality predicts purchase intentions for women's shampoo. The interaction between pink tax conditions and gender equality awareness holds for pink tax w/o justification, color and fragrance justifications. No significant interaction was found for the design, ingredient, and marketing message justification conditions (they appear more gender-equal?).Significant interaction was found between pink tax and price sensitivity for the ingredient condition, suggesting that higher price sensitivity people may be less likely to be justified by ingredient difference. 

When there is only pink tax without justification, higher gender equality awareness predicts lower purchase intentions. Price sensitivity predicts lower purchase intention for ingredient and fragrance justifications. Negative interaction was found between color justification and gender equality awareness (i.e., more awareness, color justification more likely to backfire on purchase intention), positive interaction was found between mkt message justfication and gender equality awareness (i.e., more awareness, mkt message justification more likely to improve purchase intention). 


```{r}
#| label: Moderation Analysis - Linear Regression - Purchase intention
#| echo: false

options(scipen = 999)
 
 # 1. Control vs. Pink tax 
 linear_control_pt_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = control_pt)
 
 # View results
 summary(linear_control_pt_mod)
 
options(scipen = 999)
 # Linear regression with income as control variable
 linear_control_design_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = ct_design)
 # View results
 summary(linear_control_design_mod)

options(scipen = 999)

 # Linear regression with income as control variable
 linear_control_color_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = ct_color)
 
 # View results
 summary(linear_control_color_mod)
 
 options(scipen = 999)

 # Linear regression with income as control variable
 linear_control_ingredient_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = ct_ingredient)
 
 # View results
summary(linear_control_ingredient_mod)

options(scipen = 999)

 # Linear regression with income as control variable
linear_control_fragrance_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = ct_fragrance)

# View results
summary(linear_control_fragrance_mod)
 

options(scipen = 999)

 # Linear regression with income as control variable
linear_control_mkt_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = ct_mkt)

# View results
summary(linear_control_mkt_mod)

# 2. Pink tax vs. pink tax with justifications
options(scipen = 999)

 # Linear regression with income as control variable
linear_pt_design_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = pt_design)

# View results
summary(linear_pt_design_mod)

options(scipen = 999)

 # Linear regression with income as control variable
linear_pt_color_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = pt_color)

# View results
summary(linear_pt_color_mod)

options(scipen = 999)

 # Linear regression with income as control variable
linear_pt_ingredient_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = pt_ingredient)

# View results
summary(linear_pt_ingredient_mod)

options(scipen = 999)

 # Linear regression with income as control variable
linear_pt_fragrance_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = pt_fragrance)

# View results
summary(linear_pt_fragrance_mod)

options(scipen = 999)

 # Linear regression with income as control variable
linear_pt_mkt_mod <- lm(bi_women ~ condition + income + gender_equality + price_sensitivity + condition:gender_equality + condition:price_sensitivity, data = pt_mkt)

# View results
summary(linear_pt_mkt_mod)


```











```







